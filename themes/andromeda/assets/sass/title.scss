@mixin pulse {
    background-color: $color-timebox;
    animation: pulse $period linear infinite;
    @keyframes pulse {
        0% {
            background-color: $color-timebox;
        }
        2% {
            background-color: $color-cable-pulse;
        }
        7% {
            background-color: $color-cable-pulse;
        }
        10% {
            background-color: $color-timebox;
        }
    }
}

@mixin flicker-stroke($d, $t) {
    animation-delay: $d;
    stroke-opacity: 0;
    animation: flicker-stroke $t ease-in infinite;
    @keyframes flicker-stroke {
        10% {stroke-opacity: 0;}
        50% {stroke-opacity: 0.15;}
        90% {stroke-opacity: 0;}
    }
}
@mixin flicker-fill($d, $t) {
    animation-delay: $d;
    fill-opacity: 0;
    animation: flicker-fill $t ease-in infinite;
    @keyframes flicker-fill {
        10% {fill-opacity: 0;}
        50% {fill-opacity: 0.4;}
        90% {fill-opacity: 0;}
    }
}

.anim {
    display: flex;
    align-items: center;
    width: 100%;
    .cable {
        margin-left: -20%;
        width: 120%;
        background: linear-gradient(90deg,
            $color-cable-base 0%,
            $color-cable-pulse 2%,
            $color-cable-pulse 8%,
            $color-cable-base 10%,
            $color-cable-base 100%);
        animation: gradient $period ease-in-out infinite;
        height: 0.8rem;
        @keyframes gradient {
            0% {
                background-position-x: 0;
            }
            10% {
                background-position-x: calc((50vw - 10rem)*1.2);
            }
            100% {
                background-position-x: calc((50vw - 10rem)*1.2);
            }
        }
    }
    .left, .right {
        flex-grow: 1;
        min-width: 1rem;
        overflow: hidden;
    }
    .right {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        height: 5rem;
        .cable {
            animation-delay: 0.7s;
        }
    }
    .tootbox {
        position: relative;
        background-color: grey;
        width: $tootbox-width;
        p {
            margin: 0;
            padding: 0 1rem;
            overflow: hidden;
        }
        .user {
            background-color: white;
            padding: 0.3rem 1rem;
            @include pulse;
            animation-delay: 0.4s;
        }
        .toot {
            margin: 0.5rem 0;
            min-height: 4rem;
        }
        .metadata {
            font-size: 0.9em;
            padding: 0.5rem 1rem;
            min-height: 1rem;
        }
        .delay {
            position: absolute;
            right: 0;
            bottom: 0;
            padding: 0.5rem 0.3rem 0.5rem 0.3rem;
            min-width: 3rem;
            text-align: center;
            @include pulse;
            animation-delay: 0.6s;
        }
    }
}

svg.galaxy {
    max-width: 110vh;
    min-width: 50rem;
    margin-left: 50%;
    transform: translateX(-50%);
    padding: 2%;
    margin-bottom: -1rem;
    fill: $color-cable-base;
    .small {
        &.path {
            stroke: $color-cable-base;
            stroke-width: 0.02rem;
            &.n1 {@include flicker-stroke(2s, 7s);}
            &.n2 {@include flicker-stroke(0, 13s);}
            &.n3 {@include flicker-stroke(1s, 9s);}
            &.n4 {@include flicker-stroke(0.5s, 8s);}
            &.n5 {@include flicker-stroke(0, 6s);}
        }
        &.star {
            &.n1 {@include flicker-fill(2s, 7s);}
            &.n2 {@include flicker-fill(0, 13s);}
            &.n3 {@include flicker-fill(1s, 9s);}
            &.n4 {@include flicker-fill(0.5s, 8s);}
            &.n5 {@include flicker-fill(0, 6s);}
        }
    }
    .big {
        &.path.n1, &.star.n1 {
            animation: bigpath1 $double-period ease-out infinite;
            @keyframes bigpath1 {
                0% {fill: $color-cable-base;}
                5% {fill: $color-cable-pulse;}
                10% {fill: $color-cable-pulse;}
                15% {fill: $color-cable-base;}

                57% {fill: $color-cable-base;}
                62% {fill: $color-cable-pulse;}
                67% {fill: $color-cable-pulse;}
                72% {fill: $color-cable-base;}
            }
        }
        &.path.n2, &.star.n2 {
            animation: bigpath2 $double-period ease-out infinite;
            @keyframes bigpath2 {
                0% {fill: $color-cable-base;}
                5% {fill: $color-cable-base;}
                10% {fill: $color-cable-pulse;}
                15% {fill: $color-cable-pulse;}
                20% {fill: $color-cable-base;}

                52% {fill: $color-cable-base;}
                57% {fill: $color-cable-pulse;}
                62% {fill: $color-cable-pulse;}
                67% {fill: $color-cable-base;}
            }
        }
        &.path.n3, &.star.n3 {
            animation: bigpath3 $double-period ease-out infinite;
            @keyframes bigpath3 {
                0% {fill: $color-cable-base;}
                6% {fill: $color-cable-base;}
                11% {fill: $color-cable-pulse;}
                16% {fill: $color-cable-pulse;}
                21% {fill: $color-cable-base;}

                58% {fill: $color-cable-base;}
                63% {fill: $color-cable-pulse;}
                68% {fill: $color-cable-pulse;}
                73% {fill: $color-cable-base;}
            }
        }
    }
    @media only screen and (max-width: $media-medium) {
        margin-bottom: -5rem;
    }
    @media only screen and (max-width: $media-narrow) {
        margin-bottom: -9rem;
    }
}

// topmost section, containing website title and description
header {
    background-color: grey;
    .small {
        display: none;
    }
    text-align: center;
    .title {
        font-size: 3rem;
        color: $fg-title;
    }
    .small {
        font-size: 3rem;
        color: $fg-title;
    }
    .desc {
        font-size: 1.5rem;
        color: yellow;
    }
    font-weight: bold;
    @media only screen and (max-width: $media-medium) {
        .title {
            font-size: 2.4rem;
        }
    }
    @media only screen and (max-width: $media-narrow) {
        .title {
            display: none;
        }
        .small {
            display: inline;
        }
        .desc {
            display: none;
        }
    }
}
